@using SOPACE_MVC.Models
@model SOPACE_MVC.Models.InsertAdmin

@{
    ViewBag.Title = "InputAdmin";
    Layout = "~/Views/MasterLayout/MasterAdmin.cshtml";
}
<div id="page-wrapper">
    <div class="row">
        <div class="col-lg-12" style="margin-top:20px">
            <h1 class="page-header">Input Admin</h1>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
    <div class="row">
            <form id="formAdd">
                <div class="col-lg-6 panel" style="background-color:lightblue">
                    <section style="margin-top:20px">
                        <div class="form-group">
                            <label> NIP *</label>
                            @Html.EditorFor(model => model.User.NIP, new { htmlAttributes = new { @class = "form-control", placeholder = "NIP", required = "true", id = "NIP" } })
                            <div><label id="asd"></label></div>
                        </div>
                        <div class="form-group">
                            <label> Username *</label>
                            @Html.EditorFor(model => model.User.username, new { htmlAttributes = new { @class = "form-control", placeholder = "Username", required = "true", id = "username" } })
                            <div><label id="asd1"></label></div>
                        </div>
                        <div class="form-group">
                            <label> Password </label>
                            <div class="input-group">
                                @Html.EditorFor(model => model.User.password, new { htmlAttributes = new { @class = "form-control", @readonly = "readonly", id = "password" } })
                                <div class="input-group-addon" style="padding:0px; background-color:transparent; border:none">
                                    <i id="showPassword" class="glyphicon glyphicon-eye-open btn btn-primary"></i>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label> Role </label>
                            
                            @Html.EditorFor(model => model.User.role, new { htmlAttributes = new { @class = "form-control", @readonly = "readonly", id = "role" } })                            
                        </div>
                        <p>(*) Harus di isi</p>
                        <div class="form-group">
                            <input type="submit" value="Create Admin" class="btn btn-success" />
                            <input type="button" value="Cancel" class="btn btn-danger"
                                   onclick="location.href='ViewAdmin'" />
                        </div>
                    </section>
                </div>
            </form>
      
    </div>
</div>
@section Script{
    <script src="~/Scripts/lodash.js"></script>
    <script>
        $("#password").val("ACEadmin");
        $("#role").val("admin");
        $("#password").attr("type", "password");
        $("#showPassword").click(function () {
            let txtPwd = $("#password");
            if (txtPwd.attr("type") == "password") {
                txtPwd.attr("type", "text");
            } else {
                txtPwd.attr("type", "password");
            }

        });
        $("#NIP").change(function () {
            $.post("@Url.Action("CekNIP","SuperAdmin")"
                ,
                {
                    nip: $("#NIP").val()
                },
                function (data) {
                    if (data == 0) {
                        $("#asd").html(`<font color="Red">NIP Tidak Terdaftar</font>`);
                        $("#asd").val(null);
                        $("#NIP").css("border-color", "red");
                    }
                    else {
                        $("#asd").html(`${data}`);
                        $("#NIP").css("border-color", "");
                    }
                });
        });

         $("#username").change(function () {
            $.post("@Url.Action("CekUsername", "SuperAdmin")"
                ,
                {
                    usrnme: $("#username").val()
                },
                function (data) {
                    if (data == 0) {
                        //console.log(`${data}`)
                        $("#asd1").html(`<font color="black">Username Available</font>`);
                        $("#username").css("border-color", "");
                    }
                    else {
                        //console.log(`${data}`);
                        $("#asd1").html(`${data}`);
                        $("#username").css("border-color", "red");
                    }
                });
        });

        $("#formAdd").on("submit", function (e) {

            e.preventDefault();
            let formdata = $(this).serialize();
            $.ajax({
                url: '@Url.Action("Add","SuperAdmin")',
                type: 'POST',
                data: formdata,
                success: function (data) {
                    alert(data);
                    location.href = "/SuperAdmin/ViewAdmin"
                }
            });
        });
    </script>
}

